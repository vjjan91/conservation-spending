<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 5 Data Analysis and Visualization {dataVis} | Conservation funding does not track drivers of biodiversity loss</title>
  <meta name="description" content="Section 5 Data Analysis and Visualization {dataVis} | Conservation funding does not track drivers of biodiversity loss" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 5 Data Analysis and Visualization {dataVis} | Conservation funding does not track drivers of biodiversity loss" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Section 5 Data Analysis and Visualization {dataVis} | Conservation funding does not track drivers of biodiversity loss" />
  <meta name="github-repo" content="vjjan91/conservation-spending" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 5 Data Analysis and Visualization {dataVis} | Conservation funding does not track drivers of biodiversity loss" />
  
  <meta name="twitter:description" content="Section 5 Data Analysis and Visualization {dataVis} | Conservation funding does not track drivers of biodiversity loss" />
  

<meta name="author" content="Vijay Ramesh1*, Jay Schoen1, Michael Levin1, Pratik Dubal2, Rochelle Thomas1, Sebastian Heilpern1, Jared Meek1, Pooja Choksi1, Don J Melnick1, Sara Kross1&quot;" />


<meta name="date" content="2020-09-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiCatFilter.html"/>
<link rel="next" href="figure-4-threats-network-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#attribution"><i class="fa fa-check"></i><b>1.1</b> Attribution</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-access"><i class="fa fa-check"></i><b>1.2</b> Data access</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.3</b> Data processing</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#affiliations"><i class="fa fa-check"></i><b>1.4</b> Affiliations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="extraction.html"><a href="extraction.html"><i class="fa fa-check"></i><b>2</b> Extraction</a><ul>
<li class="chapter" data-level="2.1" data-path="extraction.html"><a href="extraction.html#grant-acquisition-and-preliminary-filtering"><i class="fa fa-check"></i><b>2.1</b> Grant Acquisition and Preliminary Filtering</a></li>
<li class="chapter" data-level="2.2" data-path="extraction.html"><a href="extraction.html#keyword-development"><i class="fa fa-check"></i><b>2.2</b> Keyword Development</a></li>
<li class="chapter" data-level="2.3" data-path="extraction.html"><a href="extraction.html#categories"><i class="fa fa-check"></i><b>2.3</b> Categories</a></li>
<li class="chapter" data-level="2.4" data-path="extraction.html"><a href="extraction.html#pre-processing-grants"><i class="fa fa-check"></i><b>2.4</b> Pre-Processing grants</a></li>
<li class="chapter" data-level="2.5" data-path="extraction.html"><a href="extraction.html#classification"><i class="fa fa-check"></i><b>2.5</b> Classification</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="filtering.html"><a href="filtering.html"><i class="fa fa-check"></i><b>3</b> Post-Validation Filtering</a><ul>
<li class="chapter" data-level="3.1" data-path="filtering.html"><a href="filtering.html#fixing-algorithm-errors-discovered-post-validation"><i class="fa fa-check"></i><b>3.1</b> Fixing algorithm errors discovered post-validation</a></li>
<li class="chapter" data-level="3.2" data-path="filtering.html"><a href="filtering.html#remove-grants-with-no-associated-dollar-amount"><i class="fa fa-check"></i><b>3.2</b> Remove grants with no associated dollar amount</a></li>
<li class="chapter" data-level="3.3" data-path="filtering.html"><a href="filtering.html#filtering-aquariumzoo-grants"><i class="fa fa-check"></i><b>3.3</b> Filtering Aquarium/Zoo Grants</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multiCatFilter.html"><a href="multiCatFilter.html"><i class="fa fa-check"></i><b>4</b> Multi-category Filtering</a><ul>
<li class="chapter" data-level="4.1" data-path="multiCatFilter.html"><a href="multiCatFilter.html#adding-category-sum-columns"><i class="fa fa-check"></i><b>4.1</b> Adding Category Sum columns</a></li>
<li class="chapter" data-level="4.2" data-path="multiCatFilter.html"><a href="multiCatFilter.html#export-multi-category-file"><i class="fa fa-check"></i><b>4.2</b> Export Multi-category file</a><ul>
<li class="chapter" data-level="4.2.1" data-path="multiCatFilter.html"><a href="multiCatFilter.html#multi-category-filtering-habitat-categories"><i class="fa fa-check"></i><b>4.2.1</b> Multi-category Filtering: Habitat Categories</a></li>
<li class="chapter" data-level="4.2.2" data-path="multiCatFilter.html"><a href="multiCatFilter.html#multi-category-filtering-bio-categories"><i class="fa fa-check"></i><b>4.2.2</b> Multi-category Filtering: Bio Categories</a></li>
<li class="chapter" data-level="4.2.3" data-path="multiCatFilter.html"><a href="multiCatFilter.html#multi-category-filtering-action-categories"><i class="fa fa-check"></i><b>4.2.3</b> Multi-category Filtering: Action Categories</a></li>
<li class="chapter" data-level="4.2.4" data-path="multiCatFilter.html"><a href="multiCatFilter.html#multi-category-filtering-threat-categories"><i class="fa fa-check"></i><b>4.2.4</b> Multi-category Filtering: Threat Categories</a></li>
<li class="chapter" data-level="4.2.5" data-path="multiCatFilter.html"><a href="multiCatFilter.html#multi-category-filtering-taxa-category"><i class="fa fa-check"></i><b>4.2.5</b> Multi-category Filtering: Taxa Category</a></li>
<li class="chapter" data-level="4.2.6" data-path="multiCatFilter.html"><a href="multiCatFilter.html#export-multi-category-data-for-analysis-and-visualization"><i class="fa fa-check"></i><b>4.2.6</b> Export Multi-Category Data for Analysis and Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-analysis-and-visualization-datavis.html"><a href="data-analysis-and-visualization-datavis.html"><i class="fa fa-check"></i><b>5</b> Data Analysis and Visualization {dataVis}</a><ul>
<li class="chapter" data-level="5.1" data-path="data-analysis-and-visualization-datavis.html"><a href="data-analysis-and-visualization-datavis.html#exploratory-visuals"><i class="fa fa-check"></i><b>5.1</b> Exploratory Visuals</a><ul>
<li class="chapter" data-level="5.1.1" data-path="data-analysis-and-visualization-datavis.html"><a href="data-analysis-and-visualization-datavis.html#grants-with-no-keywords"><i class="fa fa-check"></i><b>5.1.1</b> Grants with No Keywords</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-analysis-and-visualization-datavis.html"><a href="data-analysis-and-visualization-datavis.html#all-grants-with-funding"><i class="fa fa-check"></i><b>5.1.2</b> All Grants with Funding</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-analysis-and-visualization-datavis.html"><a href="data-analysis-and-visualization-datavis.html#bio-subset"><i class="fa fa-check"></i><b>5.1.3</b> Bio Subset</a></li>
<li class="chapter" data-level="5.1.4" data-path="data-analysis-and-visualization-datavis.html"><a href="data-analysis-and-visualization-datavis.html#money-data"><i class="fa fa-check"></i><b>5.1.4</b> Money Data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-analysis-and-visualization-datavis.html"><a href="data-analysis-and-visualization-datavis.html#manuscript-figures"><i class="fa fa-check"></i><b>5.2</b> Manuscript Figures</a><ul>
<li class="chapter" data-level="5.2.1" data-path="data-analysis-and-visualization-datavis.html"><a href="data-analysis-and-visualization-datavis.html#figure-1-proportion-of-money-vs.-species-threatened"><i class="fa fa-check"></i><b>5.2.1</b> Figure 1: Proportion of Money vs. Species Threatened</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-analysis-and-visualization-datavis.html"><a href="data-analysis-and-visualization-datavis.html#figure-2-amount-of-money-allocated-across-unique-threat-categories-per-year"><i class="fa fa-check"></i><b>5.2.2</b> Figure 2: Amount of Money Allocated Across Unique Threat Categories per Year</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-analysis-and-visualization-datavis.html"><a href="data-analysis-and-visualization-datavis.html#figure-3-taxathreat-maxwell-comparison"><i class="fa fa-check"></i><b>5.2.3</b> Figure 3: Taxa/Threat Maxwell Comparison</a></li>
<li class="chapter" data-level="5.2.4" data-path="data-analysis-and-visualization-datavis.html"><a href="data-analysis-and-visualization-datavis.html#figure-4-network-analysis"><i class="fa fa-check"></i><b>5.2.4</b> Figure 4: Network Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="figure-4-threats-network-analysis.html"><a href="figure-4-threats-network-analysis.html"><i class="fa fa-check"></i><b>6</b> Figure 4: Threats Network Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="figure-4-threats-network-analysis.html"><a href="figure-4-threats-network-analysis.html#threat-category-overlap"><i class="fa fa-check"></i><b>6.1</b> Threat Category Overlap</a></li>
<li class="chapter" data-level="6.2" data-path="figure-4-threats-network-analysis.html"><a href="figure-4-threats-network-analysis.html#pie-charts"><i class="fa fa-check"></i><b>6.2</b> Pie Charts</a><ul>
<li class="chapter" data-level="6.2.1" data-path="figure-4-threats-network-analysis.html"><a href="figure-4-threats-network-analysis.html#of-threats-within-threat-categories-number-of-grants-not"><i class="fa fa-check"></i><b>6.2.1</b> # of Threats within Threat categories (number of grants, not $)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="figure-4-threats-network-analysis.html"><a href="figure-4-threats-network-analysis.html#supplemental-figures"><i class="fa fa-check"></i><b>6.3</b> Supplemental Figures</a><ul>
<li class="chapter" data-level="6.3.1" data-path="figure-4-threats-network-analysis.html"><a href="figure-4-threats-network-analysis.html#figure-s1-total-biodiversityclimate-change-grantmaking-by-top-1000-grantmakers"><i class="fa fa-check"></i><b>6.3.1</b> Figure S1: Total Biodiversity/Climate Change Grantmaking by Top 1000 Grantmakers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rbc.html"><a href="rbc.html"><i class="fa fa-check"></i><b>7</b> Rule Based Classification</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Conservation funding does not track drivers of biodiversity loss</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-analysis-and-visualization-datavis" class="section level1">
<h1><span class="header-section-number">Section 5</span> Data Analysis and Visualization {dataVis}</h1>
<div id="exploratory-visuals" class="section level2">
<h2><span class="header-section-number">5.1</span> Exploratory Visuals</h2>
<div id="grants-with-no-keywords" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Grants with No Keywords</h3>
<p>This is a plot featuring the 50 largest grants that have no keywords associated with them.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">no_keywords &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Keywords <span class="op">==</span><span class="st">&quot;[&#39;-&#39;]&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(Grant.Amount))</a>
<a class="sourceLine" id="cb12-4" title="4">no_keywords_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(no_keywords[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,],</a>
<a class="sourceLine" id="cb12-5" title="5">                            <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(<span class="kw">row.names</span>(no_keywords[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,]), <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>),</a>
<a class="sourceLine" id="cb12-6" title="6">                                <span class="dt">y =</span> Grant.Amount)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;No Keyword Biggest Grants (50)&quot;</span>,</a>
<a class="sourceLine" id="cb12-10" title="10">       <span class="dt">x =</span> <span class="st">&quot;Rank&quot;</span>,</a>
<a class="sourceLine" id="cb12-11" title="11">       <span class="dt">y =</span> <span class="st">&quot;Money ($US)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>comma)</a>
<a class="sourceLine" id="cb12-13" title="13">no_keywords_plot</a></code></pre></div>
</div>
<div id="all-grants-with-funding" class="section level3">
<h3><span class="header-section-number">5.1.2</span> All Grants with Funding</h3>
<p>Here we lengthen the data to more properly examine and visualize where the money from each grant is being allocated.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">data &lt;-<span class="st"> </span><span class="kw">filter</span>(data, Keywords <span class="op">!=</span><span class="st"> &quot;[&#39;-&#39;]&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Year.Authorized <span class="op">&lt;</span><span class="st"> </span><span class="dv">2017</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw">filter</span>(Year.Authorized <span class="op">!=</span><span class="st"> </span><span class="dv">2002</span>)</a>
<a class="sourceLine" id="cb13-4" title="4">data.multi &lt;-<span class="st"> </span><span class="kw">filter</span>(data.multi, Keywords <span class="op">!=</span><span class="st"> &quot;[&#39;-&#39;]&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">  </span><span class="kw">filter</span>(Year.Authorized <span class="op">&lt;</span><span class="st"> </span><span class="dv">2017</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="st">  </span><span class="kw">filter</span>(Year.Authorized <span class="op">!=</span><span class="st"> </span><span class="dv">2002</span>)</a>
<a class="sourceLine" id="cb13-7" title="7"></a>
<a class="sourceLine" id="cb13-8" title="8">money.data &lt;-<span class="st"> </span>data[,<span class="dv">11</span><span class="op">:</span>(<span class="kw">length</span>(data)<span class="op">-</span><span class="dv">6</span>)]<span class="op">*</span>data[,<span class="dv">7</span>]</a>
<a class="sourceLine" id="cb13-9" title="9">money.data &lt;-<span class="st"> </span><span class="kw">mutate</span>(money.data, <span class="dt">Year.Authorized =</span> data<span class="op">$</span>Year.Authorized)</a>
<a class="sourceLine" id="cb13-10" title="10"></a>
<a class="sourceLine" id="cb13-11" title="11">by.year.money &lt;-<span class="st"> </span>money.data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="st">  </span><span class="kw">group_by</span>(Year.Authorized) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="st">  </span><span class="kw">summarize_at</span>(<span class="kw">vars</span>(cat_act_area<span class="op">:</span>cat_taxa_other), sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Year.Authorized, <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Amount&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> Amount<span class="op">/</span><span class="kw">sum</span>(Amount))</a></code></pre></div>
</div>
<div id="bio-subset" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Bio Subset</h3>
<p>Here we remove those climate/energy grants that do not contain biodiversity conservation keywords.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># Single Category Data</span></a>
<a class="sourceLine" id="cb14-2" title="2">data_bio<span class="fl">.1</span> &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span><span class="kw">filter_at</span>(<span class="kw">vars</span>(biodiv.bio.taxa.hab_cat), <span class="kw">any_vars</span>(.<span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)) </a>
<a class="sourceLine" id="cb14-4" title="4">data_non.bio<span class="fl">.1</span> &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="st">  </span><span class="kw">filter_at</span>(<span class="kw">vars</span>(biodiv.bio.taxa.hab_cat), <span class="kw">all_vars</span>(. <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb14-6" title="6"></a>
<a class="sourceLine" id="cb14-7" title="7">data_bio<span class="fl">.2</span> &lt;-<span class="st"> </span>data_non.bio<span class="fl">.1</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="st">  </span><span class="kw">filter_at</span>(<span class="kw">vars</span>(clim.energy_cat), <span class="kw">all_vars</span>(.<span class="op">==</span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb14-9" title="9">data_non.bio<span class="fl">.2</span> &lt;-<span class="st"> </span>data_non.bio<span class="fl">.1</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="st">  </span><span class="kw">filter_at</span>(<span class="kw">vars</span>(clim.energy_cat), <span class="kw">any_vars</span>(.<span class="op">&gt;</span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb14-11" title="11"></a>
<a class="sourceLine" id="cb14-12" title="12">data_bio &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(data_bio<span class="fl">.1</span>, data_bio<span class="fl">.2</span>)</a>
<a class="sourceLine" id="cb14-13" title="13">data_non.bio &lt;-<span class="st"> </span>data_non.bio<span class="fl">.2</span></a>
<a class="sourceLine" id="cb14-14" title="14"></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="co"># Multi-category Data</span></a>
<a class="sourceLine" id="cb14-16" title="16">data.multi_bio<span class="fl">.1</span> &lt;-<span class="st"> </span>data.multi <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="st">  </span><span class="kw">filter_at</span>(<span class="kw">vars</span>(biodiv.bio.taxa.hab_cat_multi), <span class="kw">any_vars</span>(.<span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)) </a>
<a class="sourceLine" id="cb14-18" title="18">data.multi_non.bio<span class="fl">.1</span> &lt;-<span class="st"> </span>data.multi <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-19" title="19"><span class="st">  </span><span class="kw">filter_at</span>(<span class="kw">vars</span>(biodiv.bio.taxa.hab_cat_multi), <span class="kw">all_vars</span>(. <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb14-20" title="20"></a>
<a class="sourceLine" id="cb14-21" title="21">data.multi_bio<span class="fl">.2</span> &lt;-<span class="st"> </span>data.multi_non.bio<span class="fl">.1</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-22" title="22"><span class="st">  </span><span class="kw">filter_at</span>(<span class="kw">vars</span>(cat_threat_climate, cat_threat_energytransport),</a>
<a class="sourceLine" id="cb14-23" title="23">            <span class="kw">all_vars</span>(.<span class="op">==</span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb14-24" title="24">data.multi_non.bio<span class="fl">.2</span> &lt;-<span class="st"> </span>data.multi_non.bio<span class="fl">.1</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-25" title="25"><span class="st">  </span><span class="kw">filter_at</span>(<span class="kw">vars</span>(cat_threat_climate, cat_threat_energytransport),</a>
<a class="sourceLine" id="cb14-26" title="26">            <span class="kw">any_vars</span>(.<span class="op">&gt;</span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb14-27" title="27"></a>
<a class="sourceLine" id="cb14-28" title="28">data.multi_bio &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(data.multi_bio<span class="fl">.1</span>, data.multi_bio<span class="fl">.2</span>)</a>
<a class="sourceLine" id="cb14-29" title="29">data.multi_non.bio &lt;-<span class="st"> </span>data.multi_non.bio<span class="fl">.2</span></a></code></pre></div>
</div>
<div id="money-data" class="section level3">
<h3><span class="header-section-number">5.1.4</span> Money Data</h3>
<p>Here we further subset the lengthened dataset featuring all grants that have associated funding and break them down at an annual resolution Those subsets include the amount of money allocated to each category per year, the amount of non-biodiversity funding by year, and the amount of money across multi-category grants per year.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># Single Category Data</span></a>
<a class="sourceLine" id="cb15-2" title="2">money.data_bio &lt;-<span class="st"> </span>data_bio[,<span class="dv">11</span><span class="op">:</span>(<span class="kw">length</span>(data_bio)<span class="op">-</span><span class="dv">6</span>)]<span class="op">*</span>data_bio[,<span class="dv">7</span>]</a>
<a class="sourceLine" id="cb15-3" title="3">money.data_bio &lt;-<span class="st"> </span><span class="kw">mutate</span>(money.data_bio,</a>
<a class="sourceLine" id="cb15-4" title="4">                         <span class="dt">Year.Authorized =</span> data_bio<span class="op">$</span>Year.Authorized,</a>
<a class="sourceLine" id="cb15-5" title="5">                         <span class="dt">Num.Thr =</span> data_bio<span class="op">$</span>Num.Thr)</a>
<a class="sourceLine" id="cb15-6" title="6"></a>
<a class="sourceLine" id="cb15-7" title="7">by.year.money_bio &lt;-<span class="st"> </span>money.data_bio <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="st">  </span><span class="kw">group_by</span>(Year.Authorized) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="st">  </span><span class="kw">summarize_at</span>(<span class="kw">vars</span>(cat_act_area<span class="op">:</span>cat_taxa_other), sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Year.Authorized, <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Amount&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="st">  </span><span class="kw">group_by</span>(Year.Authorized) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ann.percent =</span> Amount<span class="op">/</span><span class="kw">sum</span>(Amount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> Amount<span class="op">/</span><span class="kw">sum</span>(Amount))</a>
<a class="sourceLine" id="cb15-15" title="15"></a>
<a class="sourceLine" id="cb15-16" title="16">money.data_non.bio &lt;-<span class="st"> </span>data_non.bio[,<span class="dv">11</span><span class="op">:</span>(<span class="kw">length</span>(data_non.bio)<span class="op">-</span><span class="dv">6</span>)]<span class="op">*</span>data_non.bio[,<span class="dv">7</span>]</a>
<a class="sourceLine" id="cb15-17" title="17">money.data_non.bio &lt;-<span class="st"> </span><span class="kw">mutate</span>(money.data_non.bio, </a>
<a class="sourceLine" id="cb15-18" title="18">                             <span class="dt">Year.Authorized =</span> data_non.bio<span class="op">$</span>Year.Authorized,</a>
<a class="sourceLine" id="cb15-19" title="19">                             <span class="dt">Num.Thr =</span> data_non.bio<span class="op">$</span>Num.Thr)</a>
<a class="sourceLine" id="cb15-20" title="20"></a>
<a class="sourceLine" id="cb15-21" title="21">by.year.money_non.bio &lt;-<span class="st"> </span>money.data_non.bio <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="st">  </span><span class="kw">group_by</span>(Year.Authorized) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-23" title="23"><span class="st">  </span><span class="kw">summarize_at</span>(<span class="kw">vars</span>(cat_act_area<span class="op">:</span>cat_threat_overexp_pollution), sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-24" title="24"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Year.Authorized, <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Amount&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-25" title="25"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-26" title="26"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> Amount<span class="op">/</span><span class="kw">sum</span>(Amount))</a>
<a class="sourceLine" id="cb15-27" title="27"></a>
<a class="sourceLine" id="cb15-28" title="28"><span class="co"># Multi-category Data</span></a>
<a class="sourceLine" id="cb15-29" title="29">money.data.multi_bio &lt;-<span class="st"> </span>data.multi_bio[,<span class="dv">11</span><span class="op">:</span>(<span class="kw">length</span>(data.multi_bio)<span class="op">-</span><span class="dv">6</span>)]<span class="op">*</span>data.multi_bio[,<span class="dv">7</span>]</a>
<a class="sourceLine" id="cb15-30" title="30">money.data.multi_bio &lt;-<span class="st"> </span><span class="kw">mutate</span>(money.data.multi_bio, </a>
<a class="sourceLine" id="cb15-31" title="31">                               <span class="dt">Year.Authorized =</span> data.multi_bio<span class="op">$</span>Year.Authorized,</a>
<a class="sourceLine" id="cb15-32" title="32">                               <span class="dt">Num.Thr =</span> data.multi_bio<span class="op">$</span>Num.Thr)</a>
<a class="sourceLine" id="cb15-33" title="33"></a>
<a class="sourceLine" id="cb15-34" title="34">by.year.money.multi_bio &lt;-<span class="st"> </span>money.data.multi_bio <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-35" title="35"><span class="st">  </span><span class="kw">group_by</span>(Year.Authorized) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-36" title="36"><span class="st">  </span><span class="kw">summarize_at</span>(<span class="kw">vars</span>(cat_act_area<span class="op">:</span>cat_threat_pollution), sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-37" title="37"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Year.Authorized, <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Amount&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-38" title="38"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-39" title="39"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> Amount<span class="op">/</span><span class="kw">sum</span>(Amount))</a></code></pre></div>
</div>
</div>
<div id="manuscript-figures" class="section level2">
<h2><span class="header-section-number">5.2</span> Manuscript Figures</h2>
<div id="figure-1-proportion-of-money-vs.-species-threatened" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Figure 1: Proportion of Money vs. Species Threatened</h3>
<p><strong>INSERT FIGURE CAPTION FROM MANUSCRIPT</strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">fig.<span class="fl">1.</span>money_bio &lt;-<span class="st"> </span>by.year.money_bio <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Category <span class="op">%in%</span><span class="st"> </span>u.threat_cat) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Total =</span> <span class="kw">sum</span>(Amount))</a>
<a class="sourceLine" id="cb16-5" title="5"></a>
<a class="sourceLine" id="cb16-6" title="6">fig.<span class="fl">1.</span>species &lt;-<span class="st"> </span>maxwell <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Category, n_species_threatened) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Total =</span> <span class="kw">sum</span>(n_species_threatened)) </a>
<a class="sourceLine" id="cb16-10" title="10"></a>
<a class="sourceLine" id="cb16-11" title="11">rawFrame &lt;-<span class="st"> </span><span class="kw">left_join</span>(fig.<span class="fl">1.</span>money_bio, fig.<span class="fl">1.</span>species, <span class="dt">by =</span> <span class="st">&quot;Category&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rawMoney =</span> Total.x) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># Total Money</span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rawSpecies =</span> Total.y) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Total Species</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Category, rawMoney, rawSpecies)</a>
<a class="sourceLine" id="cb16-15" title="15"></a>
<a class="sourceLine" id="cb16-16" title="16">fig.<span class="fl">1.</span>data_bio &lt;-<span class="st"> </span><span class="kw">left_join</span>(fig.<span class="fl">1.</span>money_bio, fig.<span class="fl">1.</span>species, <span class="dt">by =</span> <span class="st">&quot;Category&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Money =</span> (Total.x<span class="op">/</span><span class="kw">sum</span>(Total.x))<span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># Percentage of Total Money</span></a>
<a class="sourceLine" id="cb16-18" title="18"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Species =</span> (Total.y<span class="op">/</span><span class="kw">sum</span>(Total.y))<span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Percentage of Total Species</span></a>
<a class="sourceLine" id="cb16-19" title="19"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Category, Money, Species) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-20" title="20"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">c</span>(Money, Species), <span class="dt">names_to =</span> <span class="st">&quot;is.Money&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Amount&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-21" title="21"><span class="st">  </span><span class="kw">left_join</span>(rawFrame, <span class="dt">by =</span> <span class="st">&quot;Category&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-22" title="22"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rawMoney =</span> <span class="kw">ifelse</span>(is.Money <span class="op">==</span><span class="st"> &quot;Species&quot;</span>, <span class="ot">NA</span>, rawMoney)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-23" title="23"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rawSpecies=</span> <span class="kw">ifelse</span>(is.Money <span class="op">==</span><span class="st"> &quot;Money&quot;</span>, <span class="ot">NA</span>, rawSpecies)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-24" title="24"><span class="st">  </span><span class="kw">replace_na</span>(<span class="kw">list</span>(<span class="dt">rawMoney =</span> <span class="st">&quot;&quot;</span>, <span class="dt">rawSpecies =</span> <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-25" title="25"><span class="st">  </span><span class="kw">unite</span>(<span class="st">&quot;rawValue&quot;</span>, rawMoney<span class="op">:</span>rawSpecies, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>, <span class="dt">remove =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-26" title="26"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rawValue =</span> <span class="kw">as.numeric</span>(rawValue),</a>
<a class="sourceLine" id="cb16-27" title="27">         <span class="dt">rawLabels =</span> <span class="kw">comma</span>(rawValue))</a>
<a class="sourceLine" id="cb16-28" title="28">fig.<span class="fl">1.</span>data_bio<span class="op">$</span>rawLabels[<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">11</span>,<span class="dv">2</span>))] &lt;-<span class="st"> </span><span class="kw">str_glue</span>(<span class="st">&quot;${round(rawFrame$rawMoney/1e6)}m&quot;</span>)</a>
<a class="sourceLine" id="cb16-29" title="29"><span class="co"># fig.1.data_bio$rawLabels[c(seq(2,12,2))] &lt;- rawFrame$rawSpecies</span></a>
<a class="sourceLine" id="cb16-30" title="30"></a>
<a class="sourceLine" id="cb16-31" title="31">fig.<span class="fl">1.</span>plot_bio &lt;-<span class="st"> </span><span class="kw">ggplot</span>(fig.<span class="fl">1.</span>data_bio, </a>
<a class="sourceLine" id="cb16-32" title="32">                      <span class="kw">aes</span>(<span class="dt">fill=</span>is.Money, </a>
<a class="sourceLine" id="cb16-33" title="33">                          <span class="dt">y=</span>Amount, </a>
<a class="sourceLine" id="cb16-34" title="34">                          <span class="dt">x=</span>Category)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-35" title="35"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-36" title="36"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Threat Category&quot;</span>, </a>
<a class="sourceLine" id="cb16-37" title="37">       <span class="dt">y=</span><span class="st">&quot;Percentage&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-38" title="38"><span class="st">       </span><span class="co"># title=&quot;% Money Allocated vs. % Species Threatened (IUCN) by Unique Threats&quot;) +</span></a>
<a class="sourceLine" id="cb16-39" title="39"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels=</span>u.threat_list) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-40" title="40"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="co"># values = c(&quot;#556B2F&quot;, &quot;#8f3c36&quot;),</span></a>
<a class="sourceLine" id="cb16-41" title="41">                    <span class="dt">values =</span> <span class="kw">alpha</span>(<span class="kw">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;orangered4&quot;</span>), <span class="fl">0.9</span>),</a>
<a class="sourceLine" id="cb16-42" title="42">                    <span class="co"># values = c(&quot;#556B2F&quot;, &quot;#708090&quot;),</span></a>
<a class="sourceLine" id="cb16-43" title="43">                    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Money ($USD Million)&quot;</span>, <span class="st">&quot;# Threatened Species&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-44" title="44"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width=</span> <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb16-45" title="45">            <span class="kw">aes</span>(<span class="dt">label =</span> rawLabels, <span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">vjust =</span> <span class="fl">-0.5</span>), <span class="dt">angle=</span><span class="dv">0</span>, <span class="dt">size=</span><span class="dv">6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-46" title="46"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">50</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-47" title="47"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb16-48" title="48"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), </a>
<a class="sourceLine" id="cb16-49" title="49">        <span class="dt">axis.ticks.length.x =</span> <span class="kw">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>),</a>
<a class="sourceLine" id="cb16-50" title="50">        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</a>
<a class="sourceLine" id="cb16-51" title="51">        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb16-52" title="52">        <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</a>
<a class="sourceLine" id="cb16-53" title="53">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a>
<a class="sourceLine" id="cb16-54" title="54"></a>
<a class="sourceLine" id="cb16-55" title="55"><span class="co"># ggsave(fig.1.plot_bio, filename = &quot;~/Columbia E3B/Conservation Group/Output V15.2/Figures/money_species_comparison.png&quot;, width=15, height=7,dpi = 300)</span></a>
<a class="sourceLine" id="cb16-56" title="56"></a>
<a class="sourceLine" id="cb16-57" title="57">fig.<span class="fl">1.</span>plot_bio</a></code></pre></div>
</div>
<div id="figure-2-amount-of-money-allocated-across-unique-threat-categories-per-year" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Figure 2: Amount of Money Allocated Across Unique Threat Categories per Year</h3>
<p><strong>INSERT FIGURE CAPTION FROM MANUSCRIPT</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">threat_temporal.data &lt;-<span class="st"> </span>by.year.money_bio <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Category <span class="op">%in%</span><span class="st"> </span>u.threat_cat)</a>
<a class="sourceLine" id="cb17-3" title="3"></a>
<a class="sourceLine" id="cb17-4" title="4">threat_temporal.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(threat_temporal.data, </a>
<a class="sourceLine" id="cb17-5" title="5">                <span class="kw">aes</span>(<span class="dt">y =</span> Amount, </a>
<a class="sourceLine" id="cb17-6" title="6">                    <span class="dt">x =</span> Year.Authorized,</a>
<a class="sourceLine" id="cb17-7" title="7">                    <span class="dt">color =</span> Category)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="st">  </span><span class="co">#geom_point() +</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">linetype =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="st">  </span><span class="co"># geom_smooth(size = 1, aes(fill = Category), show.legend = FALSE) +</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> cat_colors22[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">13</span>,<span class="dv">11</span>,<span class="dv">20</span>,<span class="dv">5</span>,<span class="dv">18</span>)],</a>
<a class="sourceLine" id="cb17-13" title="13">                     <span class="dt">name=</span><span class="st">&quot;Threat Category&quot;</span>,</a>
<a class="sourceLine" id="cb17-14" title="14">                     <span class="dt">labels=</span>u.threat_list) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> cat_colors7) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Year&quot;</span>, </a>
<a class="sourceLine" id="cb17-17" title="17">       <span class="dt">y=</span><span class="st">&quot;Money ($US Million)&quot;</span>, </a>
<a class="sourceLine" id="cb17-18" title="18">       <span class="dt">title=</span><span class="st">&quot;Amount of Money Allocated Across Unique Threat Categories per Year&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="co">#labels = waiver(),</span></a>
<a class="sourceLine" id="cb17-20" title="20">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">50e6</span>,<span class="fl">10e7</span>),</a>
<a class="sourceLine" id="cb17-21" title="21">                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;50&quot;</span>,<span class="st">&quot;100&quot;</span>),</a>
<a class="sourceLine" id="cb17-22" title="22">                     <span class="dt">position =</span> <span class="st">&quot;right&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-23" title="23"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</a>
<a class="sourceLine" id="cb17-24" title="24">        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</a>
<a class="sourceLine" id="cb17-25" title="25">        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</a>
<a class="sourceLine" id="cb17-26" title="26">        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb17-27" title="27">        <span class="dt">legend.key.width =</span> <span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</a>
<a class="sourceLine" id="cb17-28" title="28">        <span class="co"># legend.box.spacing = unit(1,&quot;cm&quot;),</span></a>
<a class="sourceLine" id="cb17-29" title="29">        <span class="dt">legend.spacing.x =</span> <span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</a>
<a class="sourceLine" id="cb17-30" title="30">        <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</a>
<a class="sourceLine" id="cb17-31" title="31">        <span class="co"># legend.background = element_rect(color = &quot;black&quot;, size = 1.2, fill = NA))</span></a>
<a class="sourceLine" id="cb17-32" title="32"></a>
<a class="sourceLine" id="cb17-33" title="33"><span class="co"># ggsave(threat_temporal.plot, filename = &quot;~/Columbia E3B/Conservation Group/Output V15.2/Figures/threat_temporal.png&quot;, width=12, height=7,dpi = 300)</span></a>
<a class="sourceLine" id="cb17-34" title="34"></a>
<a class="sourceLine" id="cb17-35" title="35"></a>
<a class="sourceLine" id="cb17-36" title="36">threat_temporal.plot</a></code></pre></div>
</div>
<div id="figure-3-taxathreat-maxwell-comparison" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Figure 3: Taxa/Threat Maxwell Comparison</h3>
<p><strong>INSERT FIGURE CAPTION FROM MANUSCRIPT</strong>
#### Coercing Maxwell’s species designations to merge with ours
We are merging the various taxa catgories used by Maxwell et al. to examine the amount of funding disbursed to various taxa. Maxwell et al.’s taxonic designations are at a higher resolution than the what we need, so we are altering them to fit the taxonomic scale we’re operating at.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">maxwell.s4 &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;~/Columbia E3B/Conservation Group/Maxwell et al table S4.csv&quot;</span>)</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw">names</span>(maxwell.s4)</a>
<a class="sourceLine" id="cb18-3" title="3"></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co"># Our species: Amphibians, Birds, Fish, Invertebrates, Mammals, Plants, Reptiles</span></a>
<a class="sourceLine" id="cb18-5" title="5"></a>
<a class="sourceLine" id="cb18-6" title="6">our.species &lt;-<span class="st"> </span>maxwell.s4 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Amphibians =</span> Amphibia,</a>
<a class="sourceLine" id="cb18-9" title="9">         <span class="dt">Birds =</span> Aves,</a>
<a class="sourceLine" id="cb18-10" title="10">         <span class="dt">Fish =</span> Actinopterygii <span class="op">+</span><span class="st"> </span>Chondrichthyes,</a>
<a class="sourceLine" id="cb18-11" title="11">         <span class="dt">Invertebrates =</span> Anthozoa <span class="op">+</span><span class="st"> </span>Gastropoda <span class="op">+</span><span class="st"> </span>Hydrozoa <span class="op">+</span><span class="st"> </span>Malacostraca <span class="op">+</span><span class="st"> </span>Myxini,</a>
<a class="sourceLine" id="cb18-12" title="12">         <span class="dt">Mammals =</span> Mammalia,</a>
<a class="sourceLine" id="cb18-13" title="13">         <span class="dt">Plants =</span> Cycadopsida <span class="op">+</span><span class="st"> </span>Liliopsida <span class="op">+</span><span class="st"> </span>Magnoliopsida <span class="op">+</span><span class="st"> </span>Pinopsida,</a>
<a class="sourceLine" id="cb18-14" title="14">         <span class="dt">Reptiles =</span> Reptilia) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">19</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dv">18</span>))</a>
<a class="sourceLine" id="cb18-16" title="16">our.species</a></code></pre></div>
<div id="figure-3" class="section level4">
<h4><span class="header-section-number">5.2.3.1</span> Figure 3</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># Preparing maxwell data</span></a>
<a class="sourceLine" id="cb19-2" title="2">fig.<span class="fl">3.</span>maxwell_data &lt;-<span class="st"> </span>our.species <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">11</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(Total<span class="op">:</span>Reptiles), sum) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">3</span><span class="op">:</span><span class="kw">length</span>(.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Total.maxwell =</span> <span class="kw">rowSums</span>(.)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">8</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="st">  </span><span class="kw">transmute_at</span>(<span class="kw">vars</span>(<span class="op">-</span>Total.maxwell), <span class="op">~</span><span class="st"> </span>(.<span class="op">/</span>Total.maxwell)<span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Threat =</span> u.threat_list) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">8</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="st">  </span><span class="kw">pivot_longer</span>(Amphibians<span class="op">:</span>Reptiles, <span class="dt">names_to =</span> <span class="st">&quot;Taxa&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Percent&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Source =</span> <span class="st">&quot;IUCN&quot;</span>, <span class="dt">direction =</span> <span class="dv">-1</span>, <span class="dt">alpha =</span> <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb19-14" title="14"></a>
<a class="sourceLine" id="cb19-15" title="15"></a>
<a class="sourceLine" id="cb19-16" title="16"><span class="co"># Preparing money data</span></a>
<a class="sourceLine" id="cb19-17" title="17">taxa_climate &lt;-<span class="st"> </span>money.data_bio <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-18" title="18"><span class="st">  </span><span class="kw">filter</span>(cat_threat_climate <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-19" title="19"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-20" title="20"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb19-21" title="21">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-22" title="22"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-23" title="23"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-24" title="24"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-25" title="25"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-26" title="26"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-27" title="27"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_climate&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-28" title="28"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb19-29" title="29"></a>
<a class="sourceLine" id="cb19-30" title="30">taxa_energy &lt;-<span class="st"> </span>money.data_bio <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-31" title="31"><span class="st">  </span><span class="kw">filter</span>(cat_threat_energytransport <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-32" title="32"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-33" title="33"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb19-34" title="34">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-35" title="35"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-36" title="36"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-37" title="37"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-38" title="38"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-39" title="39"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-40" title="40"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_energytransport&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-41" title="41"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb19-42" title="42"></a>
<a class="sourceLine" id="cb19-43" title="43">taxa_habitat &lt;-<span class="st"> </span>money.data_bio <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-44" title="44"><span class="st">  </span><span class="kw">filter</span>(cat_threat_habitat <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-45" title="45"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-46" title="46"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb19-47" title="47">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-48" title="48"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-49" title="49"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-50" title="50"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-51" title="51"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-52" title="52"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-53" title="53"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_habitat&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-54" title="54"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb19-55" title="55"></a>
<a class="sourceLine" id="cb19-56" title="56">taxa_inv &lt;-<span class="st"> </span>money.data_bio <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-57" title="57"><span class="st">  </span><span class="kw">filter</span>(cat_threat_inv_spec <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-58" title="58"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-59" title="59"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb19-60" title="60">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-61" title="61"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-62" title="62"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-63" title="63"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-64" title="64"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-65" title="65"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-66" title="66"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_inv_spec&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-67" title="67"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb19-68" title="68"></a>
<a class="sourceLine" id="cb19-69" title="69">taxa_overexp &lt;-<span class="st"> </span>money.data_bio <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-70" title="70"><span class="st">  </span><span class="kw">filter</span>(cat_threat_overexp <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-71" title="71"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-72" title="72"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb19-73" title="73">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-74" title="74"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-75" title="75"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-76" title="76"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-77" title="77"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-78" title="78"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-79" title="79"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_overexp&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-80" title="80"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb19-81" title="81"></a>
<a class="sourceLine" id="cb19-82" title="82">taxa_pollution &lt;-<span class="st"> </span>money.data_bio <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-83" title="83"><span class="st">  </span><span class="kw">filter</span>(cat_threat_pollution <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-84" title="84"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-85" title="85"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb19-86" title="86">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-87" title="87"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-88" title="88"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-89" title="89"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-90" title="90"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-91" title="91"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-92" title="92"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_pollution&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-93" title="93"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb19-94" title="94"></a>
<a class="sourceLine" id="cb19-95" title="95">fig.<span class="fl">3.</span>money_data &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(taxa_climate, taxa_energy, taxa_habitat, </a>
<a class="sourceLine" id="cb19-96" title="96">                         taxa_inv, taxa_overexp, taxa_pollution) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-97" title="97"><span class="st">  </span><span class="kw">transmute_all</span>(<span class="op">~</span>.<span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-98" title="98"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Threat =</span> u.threat_list) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-99" title="99"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">8</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-100" title="100"><span class="st">  </span><span class="kw">pivot_longer</span>(Amphibians<span class="op">:</span>Reptiles, <span class="dt">names_to =</span> <span class="st">&quot;Taxa&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Percent&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-101" title="101"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Source =</span> <span class="st">&quot;Money&quot;</span>, <span class="dt">direction =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-102" title="102"></a>
<a class="sourceLine" id="cb19-103" title="103"><span class="co">### 1 plot</span></a>
<a class="sourceLine" id="cb19-104" title="104">fig.<span class="fl">3.</span>data &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(fig.<span class="fl">3.</span>money_data, fig.<span class="fl">3.</span>maxwell_data) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-105" title="105"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Percent =</span> Percent <span class="op">*</span><span class="st"> </span>direction,</a>
<a class="sourceLine" id="cb19-106" title="106">         <span class="dt">Taxa =</span> <span class="kw">factor</span>(Taxa, </a>
<a class="sourceLine" id="cb19-107" title="107">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Reptiles&quot;</span>, <span class="st">&quot;Amphibians&quot;</span>, <span class="st">&quot;Invertebrates&quot;</span>, </a>
<a class="sourceLine" id="cb19-108" title="108">                                  <span class="st">&quot;Birds&quot;</span>, <span class="st">&quot;Mammals&quot;</span>, <span class="st">&quot;Fish&quot;</span>, <span class="st">&quot;Plants&quot;</span>),</a>
<a class="sourceLine" id="cb19-109" title="109">                       <span class="dt">ordered =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb19-110" title="110">         <span class="dt">Threat =</span> <span class="kw">factor</span>(Threat,</a>
<a class="sourceLine" id="cb19-111" title="111">                         <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Climate Change&quot;</span>, <span class="st">&quot;Overexploitation&quot;</span>,</a>
<a class="sourceLine" id="cb19-112" title="112">                                    <span class="st">&quot;Habitat Loss&quot;</span>, <span class="st">&quot;Energy &amp; Transportation&quot;</span>,</a>
<a class="sourceLine" id="cb19-113" title="113">                                    <span class="st">&quot;Pollution&quot;</span>, <span class="st">&quot;Invasive Species&quot;</span>),</a>
<a class="sourceLine" id="cb19-114" title="114">                         <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb19-115" title="115">  )</a>
<a class="sourceLine" id="cb19-116" title="116"></a>
<a class="sourceLine" id="cb19-117" title="117">fig<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(fig.<span class="fl">3.</span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Taxa <span class="op">!=</span><span class="st"> &quot;Reptiles&quot;</span>),</a>
<a class="sourceLine" id="cb19-118" title="118">                <span class="kw">aes</span>(<span class="dt">x =</span> Taxa, <span class="dt">y =</span> Percent, <span class="dt">fill =</span> Taxa)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-119" title="119"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">show.legend =</span> F , <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-120" title="120"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-121" title="121"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> cat_colors22[<span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">20</span>,<span class="dv">19</span>,<span class="dv">15</span>,<span class="dv">7</span>,<span class="dv">11</span>)],</a>
<a class="sourceLine" id="cb19-122" title="122">                    <span class="dt">name =</span> <span class="st">&quot;Taxa&quot;</span>,</a>
<a class="sourceLine" id="cb19-123" title="123">                    <span class="dt">labels =</span> u.taxa_list) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-124" title="124"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Threat) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-125" title="125"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-126" title="126"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.ticks.y=</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb19-127" title="127">        <span class="co"># axis.text.y = element_text(size = 10, face = &quot;bold&quot;),</span></a>
<a class="sourceLine" id="cb19-128" title="128">        <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb19-129" title="129">        <span class="co"># axis.text.y = element_text(size = 12),</span></a>
<a class="sourceLine" id="cb19-130" title="130">        <span class="co"># axis.title = element_text(size = 16, face = &quot;bold&quot;),</span></a>
<a class="sourceLine" id="cb19-131" title="131">        <span class="dt">axis.ticks.x=</span><span class="kw">element_line</span>(<span class="dt">color=</span><span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb19-132" title="132">        <span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb19-133" title="133">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-134" title="134"><span class="st">  </span><span class="kw">ylim</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">90</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-135" title="135"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Percent of Taxa Threatened (IUCN) by vs. Funded for Unique Threats&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-136" title="136"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;% Taxa Threatened   |    % Funding to Taxa&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-137" title="137"><span class="st">  </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb19-138" title="138"></a>
<a class="sourceLine" id="cb19-139" title="139"><span class="co"># ggsave(fig.3, filename = &quot;~/Columbia E3B/Conservation Group/Output V15.2/Figures/taxa_threat_comparison.png&quot;, width=12, height=7,dpi = 300)</span></a>
<a class="sourceLine" id="cb19-140" title="140"></a>
<a class="sourceLine" id="cb19-141" title="141">fig<span class="fl">.3</span></a></code></pre></div>
</div>
</div>
<div id="figure-4-network-analysis" class="section level3">
<h3><span class="header-section-number">5.2.4</span> Figure 4: Network Analysis</h3>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiCatFilter.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="figure-4-threats-network-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/vjjan91/conservation-spending/edit/master/04-dataVis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
