<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 8 Taxononmic groups/Threats mismatch | Conservation funding does not track drivers of biodiversity loss</title>
  <meta name="description" content="Section 8 Taxononmic groups/Threats mismatch | Conservation funding does not track drivers of biodiversity loss" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 8 Taxononmic groups/Threats mismatch | Conservation funding does not track drivers of biodiversity loss" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Section 8 Taxononmic groups/Threats mismatch | Conservation funding does not track drivers of biodiversity loss" />
  <meta name="github-repo" content="vjjan91/conservation-spending" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 8 Taxononmic groups/Threats mismatch | Conservation funding does not track drivers of biodiversity loss" />
  
  <meta name="twitter:description" content="Section 8 Taxononmic groups/Threats mismatch | Conservation funding does not track drivers of biodiversity loss" />
  

<meta name="author" content="Vijay Ramesh1*, Jay Schoen1, Michael Levin1, Pratik Dubal2, Sebastian Heilpern1, Pooja Choksi1, Jared Meek1, Rochelle Thomas1, Don J Melnick1, Sara Kross1&quot;" />


<meta name="date" content="2020-09-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="temporal-trends-in-conservation-funding.html"/>
<link rel="next" href="network-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#attribution"><i class="fa fa-check"></i><b>1.1</b> Attribution</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-access"><i class="fa fa-check"></i><b>1.2</b> Data access</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.3</b> Data processing</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#affiliations"><i class="fa fa-check"></i><b>1.4</b> Affiliations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pre-processing-and-filtering-of-grants.html"><a href="pre-processing-and-filtering-of-grants.html"><i class="fa fa-check"></i><b>2</b> Pre-processing and filtering of grants</a></li>
<li class="chapter" data-level="3" data-path="filtering-of-grants-using-stopwords.html"><a href="filtering-of-grants-using-stopwords.html"><i class="fa fa-check"></i><b>3</b> Filtering of grants using stopwords</a></li>
<li class="chapter" data-level="4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="5" data-path="post-processing-of-grants.html"><a href="post-processing-of-grants.html"><i class="fa fa-check"></i><b>5</b> Post-processing of grants</a></li>
<li class="chapter" data-level="6" data-path="mismatch-between-conservation-funding-and-drivers-of-biodiversity-loss.html"><a href="mismatch-between-conservation-funding-and-drivers-of-biodiversity-loss.html"><i class="fa fa-check"></i><b>6</b> Mismatch between conservation funding and drivers of biodiversity loss</a></li>
<li class="chapter" data-level="7" data-path="temporal-trends-in-conservation-funding.html"><a href="temporal-trends-in-conservation-funding.html"><i class="fa fa-check"></i><b>7</b> Temporal trends in conservation funding</a></li>
<li class="chapter" data-level="8" data-path="taxononmic-groupsthreats-mismatch.html"><a href="taxononmic-groupsthreats-mismatch.html"><i class="fa fa-check"></i><b>8</b> Taxononmic groups/Threats mismatch</a></li>
<li class="chapter" data-level="9" data-path="network-analysis.html"><a href="network-analysis.html"><i class="fa fa-check"></i><b>9</b> Network Analysis</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Conservation funding does not track drivers of biodiversity loss</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="taxononmic-groupsthreats-mismatch" class="section level1">
<h1><span class="header-section-number">Section 8</span> Taxononmic groups/Threats mismatch</h1>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># Load libraries</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb32-3" title="3"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb32-4" title="4"><span class="kw">library</span>(ggsci)</a></code></pre></div>
<p>For this analysis, we are using the data.multi dataframe, as amphibians/invertebrates were found to have a much higher proportion of their money coming from grants that targeted multiple taxa (e.g. taxa_amphibian + taxa_bird). As the subsequent figure shows, even using data.multi (which over-represents amphibians/invertebrates), these two categories still show major mismatches with funding.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">data.multi &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data</span><span class="ch">\\</span><span class="st">post-processed-grants-for-analysis-multi.csv&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="st">  </span><span class="kw">as.data.frame</span>()</a>
<a class="sourceLine" id="cb33-3" title="3"></a>
<a class="sourceLine" id="cb33-4" title="4">maxwell.tab.s4 &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data</span><span class="ch">\\</span><span class="st">maxwell-tab-s4.csv&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="st">  </span><span class="kw">as.data.frame</span>()</a></code></pre></div>
<p>Categories used for analysis</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">u.threat_cat &lt;-<span class="st"> </span><span class="kw">names</span>(data.multi)[<span class="dv">37</span><span class="op">:</span><span class="dv">42</span>]</a>
<a class="sourceLine" id="cb34-2" title="2">u.taxa_cat &lt;-<span class="st"> </span><span class="kw">names</span>(data.multi)[<span class="dv">30</span><span class="op">:</span><span class="dv">36</span>]</a>
<a class="sourceLine" id="cb34-3" title="3"></a>
<a class="sourceLine" id="cb34-4" title="4">u.threat_list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Climate Change&quot;</span>, </a>
<a class="sourceLine" id="cb34-5" title="5">                   <span class="st">&quot;Energy/Transportation&quot;</span>,</a>
<a class="sourceLine" id="cb34-6" title="6">                   <span class="st">&quot;Habitat Loss&quot;</span>,</a>
<a class="sourceLine" id="cb34-7" title="7">                   <span class="st">&quot;Invasive Species&quot;</span>,</a>
<a class="sourceLine" id="cb34-8" title="8">                   <span class="st">&quot;Overexploitation&quot;</span>,</a>
<a class="sourceLine" id="cb34-9" title="9">                   <span class="st">&quot;Pollution&quot;</span>)</a>
<a class="sourceLine" id="cb34-10" title="10">u.taxa_list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Amphibians&quot;</span>,</a>
<a class="sourceLine" id="cb34-11" title="11">                 <span class="st">&quot;Birds&quot;</span>,</a>
<a class="sourceLine" id="cb34-12" title="12">                 <span class="st">&quot;Fish&quot;</span>,</a>
<a class="sourceLine" id="cb34-13" title="13">                 <span class="st">&quot;Invertebrates&quot;</span>,</a>
<a class="sourceLine" id="cb34-14" title="14">                 <span class="st">&quot;Mammals&quot;</span>,</a>
<a class="sourceLine" id="cb34-15" title="15">                 <span class="st">&quot;Plants&quot;</span>,</a>
<a class="sourceLine" id="cb34-16" title="16">                 <span class="st">&quot;Reptiles&quot;</span>)</a></code></pre></div>
<p>Colors used for plots</p>
<p>Data on funding</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># Multi-category Data</span></a>
<a class="sourceLine" id="cb35-2" title="2">money.data.multi &lt;-<span class="st"> </span>data.multi[,<span class="dv">11</span><span class="op">:</span>(<span class="kw">length</span>(data.multi)<span class="op">-</span><span class="dv">6</span>)]<span class="op">*</span>data.multi[,<span class="dv">7</span>]</a>
<a class="sourceLine" id="cb35-3" title="3">money.data.multi &lt;-<span class="st"> </span><span class="kw">mutate</span>(money.data.multi, </a>
<a class="sourceLine" id="cb35-4" title="4">                               <span class="dt">Year.Authorized =</span> data.multi<span class="op">$</span>Year.Authorized,</a>
<a class="sourceLine" id="cb35-5" title="5">                               <span class="dt">Num.Thr =</span> data.multi<span class="op">$</span>Num.Thr,</a>
<a class="sourceLine" id="cb35-6" title="6">                               <span class="dt">Num.Tax =</span> data.multi<span class="op">$</span>Num.Tax)</a>
<a class="sourceLine" id="cb35-7" title="7"></a>
<a class="sourceLine" id="cb35-8" title="8">by.year.money.multi &lt;-<span class="st"> </span>money.data.multi <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="st">  </span><span class="kw">group_by</span>(Year.Authorized) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="st">  </span><span class="kw">summarize_at</span>(<span class="kw">vars</span>(cat_act_area<span class="op">:</span>cat_threat_pollution), sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-11" title="11"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Year.Authorized, <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Amount&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-12" title="12"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-13" title="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> Amount<span class="op">/</span><span class="kw">sum</span>(Amount))</a></code></pre></div>
<p>Fig. 3: Threat/taxonomic group mismatch in terms of conservation funding and number of threatened species</p>
<p>Maxwell et al. 2016’s taxonomic designations are at a higher resolution than the what we need, so we compiled several categories to fit the taxonomic scale we’re operating at, which includes 6 categories (Amphibians, Birds, Fish, Invertebrates, Mammals, Plants, Reptiles).</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">names</span>(maxwell.tab.s4)[<span class="dv">4</span><span class="op">:</span><span class="dv">18</span>]</a>
<a class="sourceLine" id="cb36-2" title="2"><span class="co"># Our species: Amphibians, Birds, Fish, Invertebrates, Mammals, Plants, Reptiles</span></a>
<a class="sourceLine" id="cb36-3" title="3"></a>
<a class="sourceLine" id="cb36-4" title="4">maxwell.data_species_threats &lt;-<span class="st"> </span>maxwell.tab.s4 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Amphibians =</span> Amphibia,</a>
<a class="sourceLine" id="cb36-7" title="7">         <span class="dt">Birds =</span> Aves,</a>
<a class="sourceLine" id="cb36-8" title="8">         <span class="dt">Fish =</span> Actinopterygii <span class="op">+</span><span class="st"> </span>Chondrichthyes,</a>
<a class="sourceLine" id="cb36-9" title="9">         <span class="dt">Invertebrates =</span> Anthozoa <span class="op">+</span><span class="st"> </span>Gastropoda <span class="op">+</span><span class="st"> </span>Hydrozoa <span class="op">+</span><span class="st"> </span>Malacostraca <span class="op">+</span><span class="st"> </span>Myxini,</a>
<a class="sourceLine" id="cb36-10" title="10">         <span class="dt">Mammals =</span> Mammalia,</a>
<a class="sourceLine" id="cb36-11" title="11">         <span class="dt">Plants =</span> Cycadopsida <span class="op">+</span><span class="st"> </span>Liliopsida <span class="op">+</span><span class="st"> </span>Magnoliopsida <span class="op">+</span><span class="st"> </span>Pinopsida,</a>
<a class="sourceLine" id="cb36-12" title="12">         <span class="dt">Reptiles =</span> Reptilia) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-13" title="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">20</span><span class="op">:</span><span class="kw">ncol</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-14" title="14"><span class="st">  </span><span class="kw">group_by</span>(Threat) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-15" title="15"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(Amphibians<span class="op">:</span>Reptiles), sum) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-16" title="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Threat =</span> u.threat_list)</a></code></pre></div>
<p>Figure 3</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co"># Preparing maxwell data</span></a>
<a class="sourceLine" id="cb37-2" title="2">fig.<span class="fl">3.</span>maxwell_data &lt;-<span class="st"> </span>maxwell.data_species_threats <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="st">  </span><span class="kw">pivot_longer</span>(Amphibians<span class="op">:</span>Reptiles, <span class="dt">names_to =</span> <span class="st">&quot;Taxon&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;n_threatened&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(Threat) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Percent =</span> <span class="dv">100</span><span class="op">*</span>n_threatened<span class="op">/</span><span class="kw">sum</span>(n_threatened),</a>
<a class="sourceLine" id="cb37-6" title="6">         <span class="dt">Source =</span> <span class="st">&quot;IUCN&quot;</span>,</a>
<a class="sourceLine" id="cb37-7" title="7">         <span class="dt">direction =</span> <span class="dv">-1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-8" title="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>n_threatened)</a>
<a class="sourceLine" id="cb37-9" title="9"></a>
<a class="sourceLine" id="cb37-10" title="10"><span class="co"># Preparing data on funding</span></a>
<a class="sourceLine" id="cb37-11" title="11">taxa_climate &lt;-<span class="st"> </span>money.data.multi <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-12" title="12"><span class="st">  </span><span class="kw">filter</span>(cat_threat_climate <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-13" title="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-14" title="14"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb37-15" title="15">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-16" title="16"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-17" title="17"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-18" title="18"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-19" title="19"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-20" title="20"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-21" title="21"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_climate&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-22" title="22"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb37-23" title="23"></a>
<a class="sourceLine" id="cb37-24" title="24">taxa_energy &lt;-<span class="st"> </span>money.data.multi <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-25" title="25"><span class="st">  </span><span class="kw">filter</span>(cat_threat_energytransport <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-26" title="26"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-27" title="27"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb37-28" title="28">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-29" title="29"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-30" title="30"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-31" title="31"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-32" title="32"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-33" title="33"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-34" title="34"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_energytransport&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-35" title="35"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb37-36" title="36"></a>
<a class="sourceLine" id="cb37-37" title="37">taxa_habitat &lt;-<span class="st"> </span>money.data.multi <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-38" title="38"><span class="st">  </span><span class="kw">filter</span>(cat_threat_habitat <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-39" title="39"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-40" title="40"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb37-41" title="41">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-42" title="42"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-43" title="43"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-44" title="44"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-45" title="45"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-46" title="46"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-47" title="47"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_habitat&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-48" title="48"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb37-49" title="49"></a>
<a class="sourceLine" id="cb37-50" title="50">taxa_inv &lt;-<span class="st"> </span>money.data.multi <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-51" title="51"><span class="st">  </span><span class="kw">filter</span>(cat_threat_inv_spec <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-52" title="52"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-53" title="53"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb37-54" title="54">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-55" title="55"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-56" title="56"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-57" title="57"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-58" title="58"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-59" title="59"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-60" title="60"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_inv_spec&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-61" title="61"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb37-62" title="62"></a>
<a class="sourceLine" id="cb37-63" title="63">taxa_overexp &lt;-<span class="st"> </span>money.data.multi <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-64" title="64"><span class="st">  </span><span class="kw">filter</span>(cat_threat_overexp <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-65" title="65"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-66" title="66"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb37-67" title="67">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-68" title="68"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-69" title="69"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-70" title="70"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-71" title="71"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-72" title="72"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-73" title="73"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_overexp&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-74" title="74"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb37-75" title="75"></a>
<a class="sourceLine" id="cb37-76" title="76">taxa_pollution &lt;-<span class="st"> </span>money.data.multi <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-77" title="77"><span class="st">  </span><span class="kw">filter</span>(cat_threat_pollution <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-78" title="78"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-79" title="79"><span class="st">  </span><span class="kw">pivot_longer</span>(cat_taxa_amphibian<span class="op">:</span>cat_taxa_reptile, </a>
<a class="sourceLine" id="cb37-80" title="80">               <span class="dt">names_to =</span> <span class="st">&quot;Category&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Money&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-81" title="81"><span class="st">  </span><span class="kw">group_by</span>(Category) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-82" title="82"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">totalAmount =</span> <span class="kw">sum</span>(Money)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-83" title="83"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> totalAmount<span class="op">/</span><span class="kw">sum</span>(totalAmount)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-84" title="84"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(perc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-85" title="85"><span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-86" title="86"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">row.names =</span> <span class="st">&quot;cat_threat_pollution&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-87" title="87"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span> (u.taxa_list)</a>
<a class="sourceLine" id="cb37-88" title="88"></a>
<a class="sourceLine" id="cb37-89" title="89">fig.<span class="fl">3.</span>money_data &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(taxa_climate, taxa_energy, taxa_habitat, </a>
<a class="sourceLine" id="cb37-90" title="90">                         taxa_inv, taxa_overexp, taxa_pollution) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-91" title="91"><span class="st">  </span><span class="kw">transmute_all</span>(<span class="op">~</span>.<span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-92" title="92"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Threat =</span> u.threat_list) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-93" title="93"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">8</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-94" title="94"><span class="st">  </span><span class="kw">pivot_longer</span>(Amphibians<span class="op">:</span>Reptiles, <span class="dt">names_to =</span> <span class="st">&quot;Taxon&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Percent&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-95" title="95"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Source =</span> <span class="st">&quot;Money&quot;</span>, <span class="dt">direction =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb37-96" title="96"></a>
<a class="sourceLine" id="cb37-97" title="97"><span class="co"># Assembling data for plot</span></a>
<a class="sourceLine" id="cb37-98" title="98">fig.<span class="fl">3.</span>data &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(fig.<span class="fl">3.</span>money_data, fig.<span class="fl">3.</span>maxwell_data) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-99" title="99"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Percent =</span> Percent <span class="op">*</span><span class="st"> </span>direction,</a>
<a class="sourceLine" id="cb37-100" title="100">         <span class="dt">Taxon =</span> <span class="kw">factor</span>(Taxon, </a>
<a class="sourceLine" id="cb37-101" title="101">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Reptiles&quot;</span>, <span class="st">&quot;Amphibians&quot;</span>, <span class="st">&quot;Invertebrates&quot;</span>, </a>
<a class="sourceLine" id="cb37-102" title="102">                                  <span class="st">&quot;Birds&quot;</span>, <span class="st">&quot;Mammals&quot;</span>, <span class="st">&quot;Fish&quot;</span>, <span class="st">&quot;Plants&quot;</span>),</a>
<a class="sourceLine" id="cb37-103" title="103">                       <span class="dt">ordered =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb37-104" title="104">         <span class="dt">Threat =</span> <span class="kw">factor</span>(Threat,</a>
<a class="sourceLine" id="cb37-105" title="105">                         <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Climate Change&quot;</span>, <span class="st">&quot;Overexploitation&quot;</span>,</a>
<a class="sourceLine" id="cb37-106" title="106">                                    <span class="st">&quot;Habitat Loss&quot;</span>, <span class="st">&quot;Energy/Transportation&quot;</span>,</a>
<a class="sourceLine" id="cb37-107" title="107">                                    <span class="st">&quot;Pollution&quot;</span>, <span class="st">&quot;Invasive Species&quot;</span>),</a>
<a class="sourceLine" id="cb37-108" title="108">                         <span class="dt">ordered =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb37-109" title="109"></a>
<a class="sourceLine" id="cb37-110" title="110"><span class="co"># Removing reptiles</span></a>
<a class="sourceLine" id="cb37-111" title="111">fig.<span class="fl">3.</span>plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(fig.<span class="fl">3.</span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Taxon <span class="op">!=</span><span class="st"> &quot;Reptiles&quot;</span>),</a>
<a class="sourceLine" id="cb37-112" title="112">                <span class="kw">aes</span>(<span class="dt">x =</span> Taxon, <span class="dt">y =</span> Percent, <span class="dt">fill =</span> Taxon)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-113" title="113"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">show.legend =</span> F , <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-114" title="114"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-115" title="115"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> cat_colors22[<span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">20</span>,<span class="dv">19</span>,<span class="dv">15</span>,<span class="dv">7</span>,<span class="dv">11</span>)],</a>
<a class="sourceLine" id="cb37-116" title="116">                    <span class="dt">name =</span> <span class="st">&quot;Taxononmic Group&quot;</span>,</a>
<a class="sourceLine" id="cb37-117" title="117">                    <span class="dt">labels =</span> u.taxa_list) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-118" title="118"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Threat) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-119" title="119"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb37-120" title="120"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.ticks.y=</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb37-121" title="121">        <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb37-122" title="122">        <span class="dt">axis.ticks.x=</span><span class="kw">element_line</span>(<span class="dt">color=</span><span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb37-123" title="123">        <span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb37-124" title="124">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-125" title="125"><span class="st">  </span><span class="kw">ylim</span>(<span class="op">-</span><span class="dv">90</span>,<span class="dv">90</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-126" title="126"><span class="st">  </span><span class="co"># ggtitle(&quot;Percent of Taxa Threatened (IUCN) by vs. Funded for Threats (multi)&quot;) +</span></a>
<a class="sourceLine" id="cb37-127" title="127"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;% Threatened | % Funding&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-128" title="128"><span class="st">  </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb37-129" title="129"></a>
<a class="sourceLine" id="cb37-130" title="130"><span class="kw">ggsave</span>(fig.<span class="fl">3.</span>plot, <span class="dt">filename =</span> <span class="st">&quot;figs</span><span class="ch">\\</span><span class="st">Fig.3.png&quot;</span>, <span class="dt">width=</span><span class="dv">12</span>, <span class="dt">height=</span><span class="dv">7</span>,<span class="dt">dpi =</span> <span class="dv">300</span>)</a></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="co"># show exported image</span></a>
<a class="sourceLine" id="cb38-2" title="2">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;figs/Fig.3.png&quot;</span>)</a></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="temporal-trends-in-conservation-funding.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="network-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/vjjan91/conservation-spending/edit/master/07_taxa-mismatch.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
